<html lang="es">
<meta charset="utf-8">
<link rel="stylesheet" type="text/css" href="cincoysiete.css" />
<link rel="manifest" href="manifest.json">
<link rel="icon" type="image/png" href="img/milogo.png" />
<meta name="viewport" content="width=device-width, initial-scale=1"/>

<!-- ELIMINAR LA CACHE -->
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
<meta http-equiv="Pragma" content="no-cache" />
<meta http-equiv="Expires" content="0" />


<title>Localiza</title>
<style>
  .imagen-para-archivo input {
    display:none;
  }
 </style>

<script type="text/javascript" src="js/javascrises.js"></script>
<script>

// Confirmar la eliminacion de un registro
function confirmar()
{
lineo=window.location.href;
linei=lineo.split("=");
elaza=localStorage.getItem(linei[1]+'localiza').split(',');
	if(confirm('\nATENCIÓN. Vas a eliminar la ubicación: '+elaza[0]+'. \n¿Deseas continuar? '))
		return true;
	else
		return false;
}

// document.addEventListener("DOMContentLoaded", function(event) { 
// palabrilla();
// });

lineo=window.location.href;
linei=lineo.split("=");

</script>
  <!-- ENCABEZADO -->
  <table width='100%' border='0' >
  <tr><td align='left' width="10%">
    <script>
    if (linei[1]>0){
      document.write('<a href="tabla.html" ><img src="img/salida.png" width="30px"></a>')
  } else {
    document.write('<a href="index.html" ><img src="img/salida.png" width="30px"></a>')
  }

</script>
  

</td><td align='center'>
  </td><td align='center' width="10%">
    <script>if (linei[1]>0){document.writeln('<center><a href="elimina.html?qw='+readCookie('registroactual')+'" style="color:#F35454;" class="button4" onclick="return confirmar();"><img src="img/eliminar.png" width="30px"></a></center>');}</script>
  </td><td align='center' width="5%">
  </td><td align='center' width="10%">

    <script>if (linei[1]>0){document.write('<button class="button4" onclick="atras()"><img src="img/flecha-izquierda.png" width="30px"></button>')}</script>
</td><td align='center' width="10%">

    <script>
    if (linei[1]>0){
      document.write('<button class="button4" onclick="alante()"><img src="img/flecha-derecha.png" width="30px"></button>');
    }
document.write('</td><td align="center" width="5%">');    
      document.write('</td><td align="center" width="10%">');
  document.writeln('<div class="imagen-para-archivo">');
      document.writeln('<label for="boton-archivo">');
        document.writeln('<img src="img/boton-guardar.png" width="30px" title="Guardar ubicación actual"/>');
        document.writeln('</label>');
        document.writeln('<input id="boton-archivo"  onclick="recibir()" />');
        document.writeln('</div>');          
      </script>

</td><td align="center" width="5%"></td><td align='center' width="10%">
    
  <a href="" id="button-share" title="Guardar la ubicación actual"><img src="img/sharethis.png" width="30px"></a>
</td></td></table>
  <br>




<form id="form_js">
<script>

lineo=window.location.href;
linei=lineo.split("=");
document.cookie="ficha="+linei[1];
if (linei[1]>0){
// Separa por comas la ubicacion a editar
linea=localStorage.getItem(linei[1]+"localiza").split(",");
document.cookie="registroactual="+linei[1];
} else {
// Separa por comas la ubicacion actual
linea=readCookie('posiactual').split(",");
}

// document.cookie="nombrem="+linea[0];
// document.cookie="localidadm="+linea[10];
// document.cookie="grupom="+linea[9];
// document.writeln(readCookie('nombrem')+'<br>');
// document.writeln(readCookie('localidadm')+'<br>');
// document.writeln(readCookie('grupom')+'<br>');

// Muestra el formulario con el registro actual y te ofrece la posibilidad de modificarlo
document.writeln('<table width="100%" border="0">');

  // NOMBRE
document.writeln('<tr><td align="right" style="background-color: #000000; color:#FFFFFF; border:2px solid #FFFFFF; border-radius:10px; height:10px">');
document.writeln('<font color="green"><b>Nombre </font>');
document.writeln('</td><td style="background-color: #FFFFFF;">');
  if (linea[0]!="ubicacion"){
document.writeln('<input class="input-field" type="text"  placeholder="" id="nombrem" value="'+linea[0]+'">');
  } else {
    // palabrilla();
    document.writeln('<input class="input-field" type="text"  placeholder="" id="nombrem" value="'+readCookie('palabra')+'">');
  }
document.writeln('</td></tr>');


// DIRECCION
document.writeln('<tr><td align="right" style="background-color: #000000; color:#FFFFFF; border:2px solid #FFFFFF; border-radius:10px; height:10px">');
document.writeln('<font color="green"><b>Direccion </font>');
document.writeln('</td><td style="background-color: #FFFFFF;">');
if (linei[1]>0){
document.writeln('<input class="input-field" type="text"  placeholder="" id="localidadm" value="'+linea[10]+'">');
} else {
document.writeln('<input class="input-field" type="text"  placeholder="" id="localidadm" value="'+readCookie('localidad')+'">');
}
document.writeln('</td></tr>');

// GRUPO
document.writeln('<tr><td align="right" style="background-color: #000000; color:#FFFFFF; border:2px solid #FFFFFF; border-radius:10px; height:10px">');
document.writeln('<font color="green"><b>Grupo </font>');
document.writeln('</td><td style="background-color: #FFFFFF;">');
document.writeln('<input class="input-field" type="text"  placeholder="" id="grupom" value="'+linea[9]+'">');
document.writeln('</td></tr>');

// FECHA
document.writeln('<tr><td align="right" style="background-color: #000000; color:#FFFFFF; border:2px solid #FFFFFF; border-radius:10px; height:10px">');
document.writeln('<font color="green"><b>Fecha </font>');
document.writeln('</td><td style="background-color: #FFFFFF;">');
if (movilise==0){
qfe=linea[1].split("-");
qan=qfe[0];
qfe[1]++;
qfe[1]="00"+qfe[1];
qme=qfe[1].substring(qfe[1].length-2);
qdi=qfe[2].substring(qfe[2].length-2);
linea[1]=qan+"-"+qme+"-"+qdi;
}

if (movilise==1){
qfe=linea[1].split("-");
qan=qfe[0];
qfe[1]++;
qfe[1]="00"+qfe[1];
qfe[2]="00"+qfe[2];
qme=qfe[1].substring(qfe[1].length-2);
qdi=qfe[2].substring(qfe[2].length-2);
linea[1]=qan+"-"+qme+"-"+qdi;
}
// document.writeln('<input class="input-field" type="date"  placeholder="" id="fecham" value="'+linea[1]+'" disabled>');
document.writeln('<input class="input-field" type="date"  placeholder="" id="fecham" value="'+linea[1]+'">');

document.writeln('</td></tr>');

// HORA
document.writeln('<tr><td align="right" style="background-color: #000000; color:#FFFFFF; border:2px solid #FFFFFF; border-radius:10px; height:10px">');
document.writeln('Hora ');
document.writeln('</td><td style="background-color: #FFFFFF;">');
qho=linea[2].split(":");
qho[0]="00"+qho[0];
qho[1]="00"+qho[1];
qho1=qho[0].substring(qho[0].length-2);
qho2=qho[1].substring(qho[1].length-2);
linea[2]=qho1+":"+qho2;
document.writeln('<input class="input-field" type="datetime"  placeholder="" id="horam" value= "'+linea[2]+'" disabled>');
document.writeln('</td></tr>');


// ALTITUD
document.writeln('<tr><td align="right" style="background-color: #000000; color:#FFFFFF; border:2px solid #FFFFFF; border-radius:10px; height:10px">');
document.writeln('Altitud ');
document.writeln('</td><td style="background-color: #FFFFFF;">');
if (linea[3]="null"){linea[3]="";}
document.writeln('<input class="input-field" step="0.01" type="number"  placeholder="" id="altitudm" value= "'+linea[3]+'" disabled>');
document.writeln('</td></tr>');

// LATITUD
document.writeln('<tr><td align="right" style="background-color: #000000; color:#FFFFFF; border:2px solid #FFFFFF; border-radius:10px; height:10px">');
document.writeln('Latitud ');
document.writeln('</td><td style="background-color: #FFFFFF;">');
document.writeln('<input class="input-field" step="0.01" type="number"  placeholder="" id="latitudm" value="'+linea[4]+'" disabled>');
document.writeln('</td></tr>');

// LONGITUD
document.writeln('<tr><td align="right" style="background-color: #000000; color:#FFFFFF; border:2px solid #FFFFFF; border-radius:10px; height:10px">');
document.writeln('Longitud ');
document.writeln('</td><td style="background-color: #FFFFFF;">');
document.writeln('<input class="input-field" step="0.01" type="number"  placeholder="" id="longitudm" value="'+linea[5]+'" disabled>');
document.writeln('</td></tr>');
document.writeln('</td></tr>');

// APROXIMACION
document.writeln('<tr><td align="right" style="background-color: #000000; color:#FFFFFF; border:2px solid #FFFFFF; border-radius:10px; height:10px">');
document.writeln('Aproximación ');
document.writeln('</td><td style="background-color: #FFFFFF;">');
document.writeln('<input class="input-field" step="0.01" type="number"  placeholder="" id="aproxm" value="'+linea[6]+'" disabled>');
document.writeln('</td></tr>');

// VELOCIDAD
document.writeln('<tr><td align="right" style="background-color: #000000; color:#FFFFFF; border:2px solid #FFFFFF; border-radius:10px; height:10px">');
document.writeln('Velocidad ');
document.writeln('</td><td style="background-color: #FFFFFF;">');
if (linea[7]=="null"){linea[7]="";}
document.writeln('<input class="input-field" step="0.01" type="number"  placeholder="" id="velocim" value="'+linea[7]+'" disabled>');
document.writeln('</td></tr>');

// TEMPERATURA
document.writeln('<tr><td align="right" style="background-color: #000000; color:#FFFFFF; border:2px solid #FFFFFF; border-radius:10px; height:10px">');
document.writeln('Temperatura ');
document.writeln('</td><td style="background-color: #FFFFFF;">');
if (linea[11]=="null"){linea[11]="";}
if (linei[1]>0){
document.writeln('<input class="input-field" step="0.01" type="number"  placeholder="" id="temperaturam" value="'+linea[11]+'" disabled>');
} else {
document.writeln('<input class="input-field" step="0.01" type="number"  placeholder="" id="temperaturam" value="'+readCookie('temperatura')+'" disabled>');
}
document.writeln('</td></tr>');

// PRESION
document.writeln('<tr><td align="right" style="background-color: #000000; color:#FFFFFF; border:2px solid #FFFFFF; border-radius:10px; height:10px">');
document.writeln('Presión ');
document.writeln('</td><td style="background-color: #FFFFFF;">');
if (linea[12]=="null"){linea[12]="";}
if (linei[1]>0){
document.writeln('<input class="input-field" step="0.01" type="number"  placeholder="" id="presionm" value="'+linea[12]+'" disabled>');
} else {
document.writeln('<input class="input-field" step="0.01" type="number"  placeholder="" id="presionm" value="'+readCookie('presion')+'" disabled>');
}
document.writeln('</td></tr>');

// HUMEDAD
document.writeln('<tr><td align="right" style="background-color: #000000; color:#FFFFFF; border:2px solid #FFFFFF; border-radius:10px; height:10px">');
document.writeln('Humedad ');
document.writeln('</td><td style="background-color: #FFFFFF;">');
if (linea[13]=="null"){linea[13]="";}
if (linei[1]>0){
document.writeln('<input class="input-field" step="0.01" type="number"  placeholder="" id="humedadm" value="'+linea[13]+'" disabled>');
} else {
document.writeln('<input class="input-field" step="0.01" type="number"  placeholder="" id="humedadm" value="'+readCookie('humedad')+'" disabled>');
}

// VIENTO
document.writeln('<tr><td align="right" style="background-color: #000000; color:#FFFFFF; border:2px solid #FFFFFF; border-radius:10px; height:10px">');
document.writeln('Viento ');
document.writeln('</td><td style="background-color: #FFFFFF;">');
if (linea[14]=="null"){linea[14]="";}
if (linei[1]>0){
document.writeln('<input class="input-field" step="0.01" type="number"  placeholder="" id="vientom" value="'+linea[13]+'" disabled>');
} else {
document.writeln('<input class="input-field" step="0.01" type="number"  placeholder="" id="vientom" value="'+readCookie('viento')+'" disabled>');
}

document.writeln('</td></tr>');


document.writeln('<tr><td align="right" style="background-color: #000000; color:#FFFFFF; border:2px solid #FFFFFF; border-radius:10px; height:10px">');

// las notas se guardan sin intros y se le ponen al mostrar el formulario
document.writeln('<font color="green"><b>Notas </font>');
document.writeln('</td><td style="background-color: #FFFFFF;">');
var notasmm=linea[8].replaceAll("·#@","\n");
document.writeln('<textarea class="input-field" rows="15" id="notasm" name="notasm" >'+notasmm+'</textarea>');
document.writeln('</td></tr>');

document.writeln('</table>');

// IR A LA UBICACION
if (linei[1]>0){
document.writeln('<center><a href="https://www.google.com/maps/dir/'+readCookie("localidad")+'/'+linea[10]+'" target="new"><img src="img/mapa.gif" width="70px"></a></center>');
}
</script>


</form>
<script>
// MUESTRA MAPA
if(navigator.onLine) {
document.writeln('<br>') ;
document.writeln('<iframe class="iframe" src="https://maps.google.com/?q='+linea[4]+','+linea[5]+'&z=18&t=k&output=embed" height="590" width="100%" frameborder="0" style="border:0" allowfullscreen></iframe>'); 
} else {

}

document.writeln('<br><br>');

</script>
<div id="escribir"></div>
<span class="colo" id="address"></span>



<script>
  if(navigator.share) {
      let buttonShare = document.getElementById("button-share");
      buttonShare.addEventListener("click", (e) => {
        e.preventDefault();
        const URL = this.href;
        pelanas=readCookie('localidad');
        lacomparto=pelanas.replace(/ /g,"20%");
        navigator.share({
          title: "LocalizaM",
          text: 'https://maps.google.com/?q='+linea[4]+','+linea[5],
          url: URL
        })
        return false;
      });
  } else {
  }
  </script>
  
